<template>
    <!-- data related to ledger -->
    <lightning-card>
        <h2>
            <lightning-icon icon-name="utility:contact" size="small"></lightning-icon>
            <strong> Ledger Data</strong>
        </h2>
        
        <div class="slds-grid slds-gutters">
            <div class="slds-col">
                <!-- <label for="startDate">Start Date:</label> -->
                <lightning-input type="date" name="startDate" label="Start Date:" value={startDate} max={endDate} onchange={handleStartDateChangeLedger} required></lightning-input>
            </div>
            <div class="slds-col">
                <!-- <label for="endDate">End Date:</label> -->
                <lightning-input type="date" name="endDate" label="End Date:" value={endDate} min={startDate} onchange={handleStartDateChangeLedger} required></lightning-input>
            </div>
        </div>    
        <br/>
        
        <lightning-button variant="brand" label="View Customer Ledger" icon-name="utility:arrow_bottom" title="Primary action" onclick={ledgerFetchHandler} disabled={isButtonDisabled} class="slds-var-m-left_x-small"></lightning-button>
    </lightning-card>
    
    
    
    
    <!-- Customer Ledger Showing Data in Modal/PopUp -->
    <template if:true={isShowModal}>
        <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open slds-modal_large">
            <div class="slds-modal__container">
                <!-- modal header start -->
                <header class="slds-modal__header" style="background-color: #7d949c;">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={hideModalBox}>
                        <div class="icon-container" style="background-color: lightblue;">
                            <lightning-icon icon-name="utility:close" size="small" style="color: red;"></lightning-icon>
                        </div>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    
                    <template if:false={isLoading}>
                        <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate"><strong> Ledger Data</strong> </h2>
                        
                    </template>
                </header>
                
                <!-- modal body start -->
                <div class="slds-modal__content" id="modal-content-id-1" style="background-color: #cccccc;">
                    
                    <!-- record for the account  -->
                    
                    <div class="slds-m-around_medium">  
                        
                        <template if:true={isLoading}>
                            <div  class="slds-m-around_medium">
                                <lightning-spinner
                                alternative-text="Loading"
                                variant="brand"
                                ></lightning-spinner>
                                
                            </div>
                        </template>
                        <template if:false={isLoading}>
                            <template if:false={showNoRecordsMessage}>
                                <div>
                                    <lightning-datatable
                                    key-field="id"
                                    data={data}
                                    columns={columns}
                                    onrowselection={getSelectedRow}
                                    hide-checkbox-column="true">
                                </lightning-datatable>
                            </div>
                            
                        </template>
                        <template if:true={showNoRecordsMessage}>
                            <div class="slds-align_absolute-center">
                                <p><strong>No Records Found!!!</strong></p>
                            </div>
                            
                        </template>
                        
                    </template>
                    
                </div>    
            </div>
            
            <!-- modal footer start-->
            <footer class="slds-modal__footer">
                <button class="slds-button slds-button_brand" onclick={showDataForEmail} disabled={showNoRecordsMessage}> 
                    <!-- <lightning-icon icon-name="utility:download" size="x-small" alternative-text="Export Excel"></lightning-icon> -->
                    <span class="text-margin">Send via Mail</span>
                </button>
                
                <button class="slds-button slds-button_brand" onclick={exportContactData} disabled={showNoRecordsMessage}> 
                    <lightning-icon icon-name="utility:download" size="x-small" alternative-text="Export Excel"></lightning-icon>
                    <span class="text-margin">Export Excel</span>
                </button> 
                
                <button class="slds-button slds-button_brand" onclick={handleGeneratePDF} disabled={showNoRecordsMessage}>
                    <lightning-icon icon-name="utility:download" size="x-small" alternative-text="Export PDF"></lightning-icon>
                    Export PDF
                </button>               
                
                <button class="slds-button slds-button_neutral" onclick={hideModalBox}>
                    <lightning-icon icon-name="utility:close" size="x-small" alternative-text="Cancel"></lightning-icon>
                    Cancel
                </button>
            </footer>
            
        </div>
    </section>
</template>

<template if:true={isShowModal1}>     
    <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-02" class="slds-modal slds-fade-in-open slds-modal_medium">
        <div class="slds-modal__container" >
            <!-- modal header start -->
            <header class="slds-modal__header" style="background-color: #7d949c;">
                <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={hideModalBox1}>
                    <div class="icon-container" style="background-color: lightblue;">
                        <lightning-icon icon-name="utility:close" size="small" style="color: red;"></lightning-icon>
                    </div>
                    <span class="slds-assistive-text">Close</span>
                </button>
                
                <template if:false={isLoading}>
                    <h2 id="modal-heading-02" class="slds-text-heading_medium slds-hyphenate">Send Email</h2>
                    
                </template>
            </header>
            
            <!-- modal body start -->
            <div class="slds-modal__content" id="modal-content-id-2" style="background-color: #cccccc;">
                
                <!-- record for the account  -->
                <div class="slds-p-around_medium">       
                    <lightning-input label="TO" type="text" onchange={handleToAddress} required></lightning-input>
                    <lightning-input label="CC" type="text" onchange={handleCCAddress}></lightning-input>
                    <lightning-input-rich-text class="slds-p-top_small" 
                    value={getEma}
                    onchange={handleRischText}
                    >
                </lightning-input-rich-text>
                <lightning-file-upload
                label="Attach File"
                name="fileUploader"
                accept={acceptedFormats}
                record-id={recordId}
                onuploadfinished={handleUploadFinished}
                multiple 
                >
            </lightning-file-upload>
            <template if:true={uploadedFileNames}>
                <template for:each={uploadedFileNames} for:item="file">
                    <p key={file}>{file}</p>
                </template>
            </template>
            <template if:false={uploadedFileNames}>
                <p>No files Found!!!</p>
            </template>
            
            
            
            <!-- <div class="slds-m-top_medium">
                
                <lightning-button label="✉️ Send" variant="brand" onclick={sendEmailData1}></lightning-button>
            </div> -->
        </div>
        
    </div>
    
    <!-- modal footer start-->
    <footer class="slds-modal__footer">
        <button class="slds-button slds-button_brand" onclick={sendEmailData1}  > 
            <!-- <lightning-icon icon-name="utility:download" size="x-small" alternative-text="Export Excel"></lightning-icon> -->
            <span class="text-margin">Send</span>
        </button>
        
        <button class="slds-button slds-button_neutral" onclick={hideModalBox1}>
            <lightning-icon icon-name="utility:close" size="x-small" alternative-text="Cancel"></lightning-icon>
            Cancel
        </button>
        
        
    </footer>
    
</div>
</section>
</template>



</template>